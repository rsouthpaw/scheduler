(window["webpackJsonpdocument-manager"]=window["webpackJsonpdocument-manager"]||[]).push([[0],{102:function(e,t,a){e.exports=a(133)},107:function(e,t,a){},133:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),l=a(9),o=a.n(l),r=(a(107),a(18)),s=a(12),c=a(21),d=a(22),u=a(25),m=a(87),h=a(34),p=a(169),g=a(173),f=a(194),v=a(191),E=a(89),b=a(166),y=a(79),k=a.n(y),w=a(42),C=a(4),x=a(35),D=a.n(x),F=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={email:"",password:""},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"login",value:function(){var e=this,t={headers:{Authorization:this.props.api}};console.log(this.state.email,this.state.password,this.props.api),D.a.post("/api/v1/login",{email:this.state.email,password:this.state.password},t).then((function(t){console.log(t),e.props.onLogin(t.data)}),(function(e){console.log(e)}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return i.a.createElement(b.a,{container:!0,component:"main",className:t.root},i.a.createElement(f.a,null),i.a.createElement(b.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),i.a.createElement(b.a,{item:!0,xs:12,sm:8,md:5,component:E.a,elevation:6,square:!0,className:t.loginArea},i.a.createElement("div",{className:t.paper},i.a.createElement(p.a,{className:t.avatar},i.a.createElement(k.a,null)),i.a.createElement(w.a,{component:"h1",variant:"h5"},"Sign in"),i.a.createElement(v.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,onChange:function(t){e.setState({email:t.target.value})}}),i.a.createElement(v.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(t){e.setState({password:t.target.value})}}),i.a.createElement(g.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,onClick:this.login.bind(this)},"Sign In"))))}}]),t}(i.a.Component),S=Object(C.a)((function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(https://images.unsplash.com/photo-1457694587812-e8bf29a43845?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1351&q=80)",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},loginArea:{background:"#fff"}}}))(F),O=a(8),j=a(179),N=a(81),_=a.n(N),I=a(86),B=a.n(I),R=a(85),L=a.n(R),A=a(84),W=a.n(A),H=a(83),T=a.n(H),M=a(183),P=a(186),U=a(185),q=a(184),G=a(180),J=a(182),z=a(192),Q=a(174),X=a(175),K=a(176),V=a(177),Y=a(181),$=a(80),Z=(a(130),{add:function(e){return D.a.post("/api/v1/files/add",{name:e.name,file_id:e.file_id,expiry:e.expiry,department:e.department},ee.getHeader())},get:function(){return D.a.get("/api/v1/files/get_all",ee.getHeader())},download:function(e,t){return fetch("/api/v1/files/fetch/"+e,{headers:new Headers({"x-api-key":window.localStorage.getItem("auth")})}).then((function(e){return e.blob()})).then((function(a){var n=window.URL.createObjectURL(a),i=document.createElement("a");i.style.display="none",i.href=n,i.download=null==t||""===t?e+".txt":t+".txt",document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(n)})).catch((function(e){return console.log(e)}))},update:function(e){return D.a.post("/api/v1/files/update",{file_id:e.file_id,data:e.data},ee.getHeader())},pullData:function(e){return D.a.get("/api/v1/files/pull/"+e,ee.getHeader())},delete:function(e){return D.a.post("/api/v1/files/delete",{file_id:e.file_id},ee.getHeader())}}),ee={getHeader:function(){return{headers:{"x-api-key":window.localStorage.getItem("auth")}}}},te=Z,ae=a(82),ne=a.n(ae),ie=a(90),le=a(187),oe=a(196),re=a(189),se=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={fileData:""},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleClose",value:function(){this.props.handleClose()}},{key:"pullFileData",value:function(){var e=this;te.pullData(this.props.fileId).then((function(t){console.log(t),t.data.success&&null!=t.data.data&&e.setState({fileData:t.data.data})}),(function(e){console.log(e)}))}},{key:"updateFile",value:function(){var e=this,t={};t.data=this.state.fileData,t.file_id=this.props.fileId,te.update(t).then((function(t){console.log(t),t.data.success&&e.props.fileUpdated()}),(function(e){console.log(e)}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return i.a.createElement("div",null,i.a.createElement(z.a,{open:this.props.open,onEnter:this.pullFileData.bind(this),onClose:this.handleClose.bind(this),"aria-labelledby":"form-dialog-title"},i.a.createElement(Q.a,{id:"form-dialog-title"},"Edit File"),i.a.createElement(X.a,null,i.a.createElement(K.a,null,"Create new revision of this file. Edit file and click on update to save new revision for file."),i.a.createElement(v.a,{id:"outlined-multiline-flexible",label:"Multiline",value:this.state.fileData,multiline:!0,rowsMax:"16",fullWidth:!0,onChange:function(t){return e.setState({fileData:t.target.value})},className:t.textField,margin:"normal",helperText:"File Contents",variant:"outlined"})),i.a.createElement(V.a,null,i.a.createElement(g.a,{onClick:this.handleClose.bind(this),color:"primary"},"Cancel"),i.a.createElement(g.a,{onClick:this.updateFile.bind(this),color:"primary"},"Update"))))}}]),t}(i.a.Component),ce=Object(C.a)((function(e){return{textField:{}}}))(se),de=a(172),ue=a(134),me=a(178),he=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"downloadFile",value:function(e){te.download(e)}},{key:"handleClose",value:function(){this.props.handleClose()}},{key:"render",value:function(){var e=this;return console.log(this.props),i.a.createElement("div",null,i.a.createElement(z.a,{open:this.props.open,onClose:this.handleClose.bind(this),"aria-labelledby":"form-dialog-title"},i.a.createElement(Q.a,{id:"form-dialog-title"},"File Revisions"),i.a.createElement(X.a,null,i.a.createElement(K.a,null,"You can see all the revisions of a file here. Click on any one of them to download."),i.a.createElement(de.a,{dense:!0},this.props.revisions.map((function(t){return i.a.createElement(ue.a,{key:t.file_id,button:!0,onClick:e.downloadFile.bind(e,t.file_id)},i.a.createElement(me.a,{primary:"Date: "+new Date(t.ts_revised).toLocaleDateString(),secondary:"Click to download"}))})))),i.a.createElement(V.a,null,i.a.createElement(g.a,{onClick:this.handleClose.bind(this),color:"primary"},"Close"))))}}]),t}(i.a.Component),pe=Object(C.a)((function(e){return{textField:{}}}))(he),ge=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={openAddDialogOpen:!1,files:[],savedFiles:[],filteredFiles:[],fileIds:[],fileName:"",department:"",showRevisionDialog:!1,expiry:new Date("2020-12-25T10:30"),description:"",editFile:!1,selectedRevisions:[]},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.fetchDocuments()}},{key:"openAddDialog",value:function(){this.setState({addDialogOpen:!0})}},{key:"closeAddDialog",value:function(){this.clearFileState(),this.setState({addDialogOpen:!1})}},{key:"handleLogout",value:function(){this.props.onLogout()}},{key:"saveFile",value:function(){var e=this;if(0!==this.state.files.length&&""!==this.state.fileName){var t={};t.file_id=this.state.files[0].serverId,t.name=this.state.fileName,t.expiry=new Date(this.state.expiry).toISOString(),t.department=this.state.department,console.log(t),te.add(t).then((function(t){console.log(t),t.data.success&&(e.closeAddDialog(),e.fetchDocuments())}),(function(e){console.log(e)}))}}},{key:"clearFileState",value:function(){this.setState({files:[]})}},{key:"fetchDocuments",value:function(){var e=this;te.get().then((function(t){console.log(t),t.data.success&&(null!=t.data.files?(e.setState({savedFiles:e.filterDocuments(t.data.files)}),e.setState({filteredFiles:e.state.savedFiles})):e.setState({savedFiles:[]}),console.log(e.state.savedFiles))}),(function(e){console.log(e)}))}},{key:"downloadFile",value:function(e,t){te.download(e,t)}},{key:"filterDocuments",value:function(e){for(var t=0;t<e.length;t++)e[t].created_at_readable=new Date(e[t].created_at).toDateString(),e[t].expiry_readable=new Date(e[t].expiry).toDateString();return e}},{key:"departmentChanged",value:function(e){console.log(this.state.department),this.setState({department:e.target.value}),console.log(this.state.department)}},{key:"editFile",value:function(e){this.setState({editFile:!0,selectedFileId:e})}},{key:"deleteFile",value:function(e){var t=this,a={};a.file_id=e,te.delete(a).then((function(e){console.log(e),e.data.success&&t.fetchDocuments()}),(function(e){console.log(e)}))}},{key:"closeEditFile",value:function(){this.setState({editFile:!1})}},{key:"fileUpdated",value:function(){this.closeEditFile(),this.fetchDocuments()}},{key:"viewRevisions",value:function(){}},{key:"searchTextChanged",value:function(e){if(null!=e.target.value&&""!==e.target.value){for(var t=e.target.value,a=this.state.savedFiles,n=[],i=0;i<a.length;i++)-1!==JSON.stringify(a[i]).toLowerCase().indexOf(t)&&n.push(a[i]);this.setState({filteredFiles:n})}else this.setState({filteredFiles:this.state.savedFiles})}},{key:"showRevisions",value:function(e,t,a){if(console.log(e),null==e||0===e.length)var n=[];else n=e.slice();var i=[];i.file_id=t,i.ts_revised=a,n.push(i),console.log(n),this.setState({showRevisionDialog:!0,selectedRevisions:n})}},{key:"closeRevisions",value:function(){this.setState({showRevisionDialog:!1})}},{key:"render",value:function(){var e=this,t=this.props.classes;return i.a.createElement("div",null,i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,null),i.a.createElement(j.a,{position:"static"},i.a.createElement(G.a,null,i.a.createElement(Y.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu"},i.a.createElement(_.a,null)),i.a.createElement(w.a,{variant:"h6",className:t.title},"Document Manager"),i.a.createElement(g.a,{color:"inherit",onClick:this.handleLogout.bind(this)},"Logout"))),i.a.createElement("main",null,i.a.createElement("div",{className:t.heroContent},i.a.createElement(J.a,{maxWidth:"sm"},i.a.createElement(w.a,{component:"h1",variant:"h2",align:"center",color:"textPrimary",gutterBottom:!0},"Documents"),i.a.createElement(w.a,{variant:"h5",align:"center",color:"textSecondary",paragraph:!0},"Add or remove documents here"),i.a.createElement("div",{className:t.heroButtons},i.a.createElement(b.a,{container:!0,spacing:2,justify:"center"},i.a.createElement(b.a,{item:!0},i.a.createElement(g.a,{variant:"contained",color:"primary",onClick:this.openAddDialog.bind(this)},"Add Document"))),i.a.createElement(b.a,{container:!0,spacing:2,justify:"center"},i.a.createElement(b.a,{item:!0},i.a.createElement(E.a,{className:t.serachBar},i.a.createElement(ne.a,null),i.a.createElement(ie.a,{className:t.inputSearchBar,onChange:function(t){return e.searchTextChanged(t)},placeholder:"Search Documents by Name, Description etc",inputProps:{"aria-label":"search"}}))))))),i.a.createElement(J.a,{className:t.cardGrid,maxWidth:"md"},i.a.createElement(b.a,{container:!0,spacing:4},this.state.filteredFiles.map((function(a){return i.a.createElement(b.a,{item:!0,key:a.id,xs:12,sm:6,md:4},i.a.createElement(M.a,{className:t.card},i.a.createElement(q.a,{className:t.cardMedia,image:"https://source.unsplash.com/random",title:"Document"}),i.a.createElement(U.a,{className:t.cardContent},i.a.createElement(w.a,{gutterBottom:!0,variant:"h5",component:"h2"},a.name),i.a.createElement(w.a,null,"Created On : ",a.created_at_readable," ",i.a.createElement("br",null),"Expires On : ",a.expiry_readable)),i.a.createElement(P.a,null,i.a.createElement(Y.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:e.downloadFile.bind(e,a.current_version_file_id,a.name)},i.a.createElement(T.a,null)),i.a.createElement(Y.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:e.showRevisions.bind(e,a.revisions,a.id,a.created_at)},i.a.createElement(W.a,null)),i.a.createElement(Y.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:e.editFile.bind(e,a.current_version_file_id)},i.a.createElement(L.a,null)),i.a.createElement(Y.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:e.deleteFile.bind(e,a.id)},i.a.createElement(B.a,null)))))}))))),i.a.createElement("footer",{className:t.footer},i.a.createElement(w.a,{variant:"h6",align:"center",gutterBottom:!0},"Saransh Miglani"),i.a.createElement(w.a,{variant:"subtitle1",align:"center",color:"textSecondary",component:"p"},"saranshmiglani@gmail.com"))),i.a.createElement(z.a,{open:this.state.addDialogOpen,onClose:this.closeAddDialog.bind(this)},i.a.createElement(Q.a,{id:"responsive-dialog-title"},"Add Document"),i.a.createElement(X.a,null,i.a.createElement(K.a,null,"Please upload your file. Enter name and expiration date for file. Click on save to store your file"),i.a.createElement(v.a,{id:"name-file",label:"Name*",fullWidth:!0,onChange:function(t){e.setState({fileName:t.target.value})},className:t.textField,margin:"normal"}),i.a.createElement(v.a,{id:"description-file",label:"Description",fullWidth:!0,onChange:function(t){e.setState({description:t.target.value})},className:t.textField,margin:"normal"}),i.a.createElement(v.a,{id:"datetime-local",label:"Expiry",type:"datetime-local",defaultValue:"2019-12-25T10:30",onChange:function(t){return e.setState({expiry:new Date(t.target.value)})},fullWidth:!0,className:t.textField,InputLabelProps:{shrink:!0}}),i.a.createElement("div",{className:t.dropdown},i.a.createElement(oe.a,{htmlFor:"age-simple"},"Department"),i.a.createElement(re.a,{className:t.dropdown,value:this.state.department,fullWidth:!0,onChange:this.departmentChanged.bind(this),inputProps:{name:"age",id:"age-simple"}},i.a.createElement(le.a,{value:""},i.a.createElement("em",null,"None")),i.a.createElement(le.a,{value:"engineering"},"Engineering"),i.a.createElement(le.a,{value:"marketing"},"Marketing"),i.a.createElement(le.a,{value:"sales"},"Sales"))),i.a.createElement($.FilePond,{ref:function(t){return e.pond=t},files:this.state.files,allowMultiple:!1,server:{url:"/api/v1/files/upload",process:{headers:{"x-api-key":window.localStorage.getItem(this.props.auth)}}},onupdatefiles:function(t){console.log(t);for(var a=[],n=0;n<t.length;n++)a.push(t[n]);e.setState({files:a})}})),i.a.createElement(V.a,null,i.a.createElement(g.a,{onClick:this.closeAddDialog.bind(this),color:"primary"},"Cancel"),i.a.createElement(g.a,Object(O.a)({onClick:this.closeAddDialog.bind(this),color:"primary",autoFocus:!0},"onClick",this.saveFile.bind(this)),"Save"))),i.a.createElement(ce,{open:this.state.editFile,fileId:this.state.selectedFileId,handleClose:this.closeEditFile.bind(this),fileUpdated:this.fileUpdated.bind(this)}),i.a.createElement(pe,{open:this.state.showRevisionDialog,handleClose:this.closeRevisions.bind(this),revisions:this.state.selectedRevisions}))}}]),t}(i.a.Component),fe=Object(C.a)((function(e){return{icon:{marginRight:e.spacing(2)},heroContent:{backgroundColor:e.palette.background.paper,padding:e.spacing(8,0,6)},heroButtons:{marginTop:e.spacing(4)},cardGrid:{paddingTop:e.spacing(8),paddingBottom:e.spacing(8)},card:{height:"100%",display:"flex",flexDirection:"column"},cardMedia:{paddingTop:"56.25%"},cardContent:{flexGrow:1},footer:{backgroundColor:e.palette.background.paper,padding:e.spacing(6)},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},textField:{margin:"6px"},inputSearchBar:{marginLeft:e.spacing(1),flex:1},serachBar:{padding:"6px 8px",display:"flex",alignItems:"center",marginTop:"20px",width:370,background:"#fff"},dropdown:{marginLeft:"6px",marginBottom:"10px",paddingTop:"6px"}}}))(ge),ve=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={loggedIn:a.getLoginStatus()},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"getLoginStatus",value:function(){var e=window.localStorage.getItem("auth");return null!==e&&""!==e}},{key:"loginHandler",value:function(e){window.localStorage.setItem("auth",e.token),this.setState({loggedIn:!0})}},{key:"logoutHandler",value:function(){window.localStorage.removeItem("auth"),this.setState({loggedIn:!1})}},{key:"render",value:function(){var e=this;return i.a.createElement(m.a,null,i.a.createElement("div",{className:"content"},this.state.loggedIn?i.a.createElement(h.a,{path:"/",render:function(t){return i.a.createElement(fe,Object.assign({onLogout:e.logoutHandler.bind(e),auth:"auth"},t))}}):i.a.createElement(h.a,{path:"/",render:function(t){return i.a.createElement(S,Object.assign({api:"vXBk4iN9JPNjjpNKWnBmlgjqjScoX3GQ",onLogin:e.loginHandler.bind(e)},t))}})))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(ve,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[102,1,2]]]);
//# sourceMappingURL=main.add923d7.chunk.js.map